<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Modal Carrito</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .cart-toggle {
            position: fixed !important; 
            right: 20px !important; 
            top: 20px !important;
            padding: 15px 20px !important; 
            border-radius: 50px !important; 
            border: none !important;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%) !important;
            color: #fff !important; 
            cursor: pointer !important; 
            z-index: 99999 !important;
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.5) !important;
            transition: all 0.3s ease !important;
            font-weight: bold !important;
            display: flex !important;
            align-items: center !important;
            gap: 8px !important;
            font-size: 16px !important;
            min-width: 140px !important;
            justify-content: center !important;
            opacity: 1 !important;
            visibility: visible !important;
            transform: none !important;
        }
        .cart-panel {
            position: fixed; 
            top: 0; 
            right: 0; 
            height: 100vh; 
            width: 380px;
            background: #fff; 
            border-left: 1px solid #e9ecef; 
            z-index: 9999;
            transform: translateX(100%); 
            transition: transform 0.3s ease;
            display: flex; 
            flex-direction: column;
            box-shadow: -5px 0 25px rgba(0, 0, 0, 0.1);
        }
        .cart-panel.open { 
            transform: translateX(0) !important; 
        }
        .cart-header {
            padding: 20px; 
            font-weight: 700; 
            color: #333; 
            border-bottom: 1px solid #e9ecef;
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            background: #f8f9fa;
        }
        .close-cart {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            padding: 5px;
            border-radius: 50%;
        }
        .test-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            background: #f8f9fa;
            border-left: 4px solid #007bff;
        }
        .error {
            background: #f8d7da;
            border-left-color: #dc3545;
            color: #721c24;
        }
        .success {
            background: #d4edda;
            border-left-color: #28a745;
            color: #155724;
        }
    </style>
</head>
<body>
    <h1>🛒 Test Modal Carrito</h1>
    
    <div class="status" id="status">
        <h3>Estado:</h3>
        <p>Verificando elementos...</p>
    </div>

    <button class="test-btn" onclick="testCart()">🧪 Test Carrito</button>
    <button class="test-btn" onclick="openCart()">🛒 Abrir Carrito</button>
    <button class="test-btn" onclick="document.querySelector('.cart-toggle').click()">🎯 Click Directo</button>

    <div id="results"></div>

    <!-- Carrito -->
    <button class="cart-toggle" type="button" id="cart-toggle" onclick="openCart(); return false;">
        🛒 Carrito
        <span class="cart-count" id="cart-count">0</span>
    </button>

    <aside class="cart-panel" id="cart-panel" aria-hidden="true">
        <div class="cart-header">
            <h3>Tu Carrito</h3>
            <button id="close-cart" type="button" class="close-cart">✕</button>
        </div>
        <div class="cart-list" id="cart-list">
            <div style="padding: 20px; text-align: center;">
                <h4>¡Carrito funcionando!</h4>
                <p>La ventana modal se abrió correctamente.</p>
            </div>
        </div>
    </aside>

    <script>
        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.innerHTML = `<h3>Estado:</h3><p>${message}</p>`;
            status.className = `status ${type}`;
        }

        function addResult(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.innerHTML = `<p>${message}</p>`;
            results.appendChild(div);
        }

        const panel = document.getElementById('cart-panel');
        const openBtn = document.getElementById('cart-toggle');
        const closeBtn = document.getElementById('close-cart');

        function open(){ 
            console.log('[CART] Abriendo carrito...');
            console.log('[CART] Panel antes:', panel.classList.toString());
            panel.classList.add('open'); 
            panel.setAttribute('aria-hidden','false');
            openBtn.classList.add('panel-open');
            console.log('[CART] Panel después:', panel.classList.toString());
            console.log('[CART] Carrito abierto');
        }
        
        function close(){ 
            console.log('[CART] Cerrando carrito...');
            panel.classList.remove('open'); 
            panel.setAttribute('aria-hidden','true');
            openBtn.classList.remove('panel-open');
            console.log('[CART] Carrito cerrado');
        }

        // Función global para abrir el carrito
        window.openCart = function() {
            console.log('[CART] Función openCart llamada');
            open();
        };

        function testCart() {
            updateStatus('Probando carrito...', 'info');
            
            const cartToggle = document.querySelector('.cart-toggle');
            const cartPanel = document.querySelector('.cart-panel');
            
            if (cartToggle) {
                addResult('✅ Botón del carrito encontrado', 'success');
                
                // Verificar estado inicial
                console.log('[CART] Estado inicial del panel:', cartPanel.classList.toString());
                
                cartToggle.click();
                addResult('✅ Click ejecutado', 'success');
                
                setTimeout(() => {
                    console.log('[CART] Estado después del click:', cartPanel.classList.toString());
                    if (cartPanel && cartPanel.classList.contains('open')) {
                        addResult('✅ Carrito se abrió correctamente', 'success');
                        updateStatus('Carrito funcionando correctamente', 'success');
                    } else {
                        addResult('❌ Carrito NO se abrió', 'error');
                        updateStatus('Error: Carrito no se abrió', 'error');
                    }
                }, 500);
            } else {
                addResult('❌ Botón del carrito NO encontrado', 'error');
                updateStatus('Error: Botón no encontrado', 'error');
            }
        }

        // Event listeners
        if (openBtn) {
            openBtn.addEventListener('click', (e) => { 
                console.log('[CART] Event listener ejecutado');
                e.preventDefault();
                open(); 
            });
        }

        if (closeBtn) {
            closeBtn.addEventListener('click', close);
        }

        // Verificar al cargar
        window.addEventListener('load', () => {
            setTimeout(() => {
                updateStatus('Página cargada. Listo para probar!', 'success');
                console.log('[CART] Elementos encontrados:', {
                    panel: !!panel,
                    openBtn: !!openBtn,
                    closeBtn: !!closeBtn
                });
            }, 1000);
        });
    </script>
</body>
</html>


