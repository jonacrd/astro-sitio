---
import BaseLayout from '../layouts/BaseLayout.astro';
import PushDiagnostic from '../components/react/PushDiagnostic.tsx';
import PushNotificationManager from '../components/react/PushNotificationManager.tsx';
---

<BaseLayout 
  title="Diagn√≥stico de Notificaciones Push - Town"
  description="Prueba y diagn√≥stico del sistema de notificaciones push"
>
  <div class="min-h-screen bg-dark-primary py-8">
    <div class="max-w-4xl mx-auto px-4">
      <div class="bg-white rounded-2xl shadow-xl p-8 mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-4">
          üîî Diagn√≥stico de Notificaciones Push
        </h1>
        <p class="text-gray-600 mb-6">
          Esta p√°gina te ayudar√° a diagnosticar y solucionar problemas con las notificaciones push.
        </p>
        
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
          <h2 class="font-semibold text-blue-900 mb-2">‚ÑπÔ∏è Instrucciones:</h2>
          <ol class="list-decimal list-inside space-y-2 text-sm text-blue-800">
            <li>Revisa el diagn√≥stico autom√°tico abajo</li>
            <li>Si hay problemas marcados en rojo, sigue las recomendaciones</li>
            <li>Para iOS: Debes instalar la app como PWA (Compartir ‚Üí Agregar a pantalla de inicio)</li>
            <li>Para otros dispositivos: Aseg√∫rate de aceptar los permisos de notificaciones</li>
          </ol>
        </div>

        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
          <h2 class="font-semibold text-yellow-900 mb-2">‚ö†Ô∏è Limitaciones de iOS:</h2>
          <p class="text-sm text-yellow-800">
            Safari en iPhone NO soporta notificaciones push en navegador web normal. 
            Debes instalar la app como PWA (√≠cono en pantalla de inicio) para que funcionen.
          </p>
        </div>

        <div class="border-t pt-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-4">üîî Activar Notificaciones</h2>
          <p class="text-gray-600 text-sm mb-4">
            Usa este bot√≥n para activar las notificaciones push:
          </p>
          <PushNotificationManager client:load />
        </div>

        <div class="border-t pt-6 mt-6">
          <h2 class="text-xl font-semibold text-gray-900 mb-4">üîç Diagn√≥stico Autom√°tico</h2>
          <p class="text-gray-600 text-sm mb-4">
            El diagn√≥stico aparecer√° en la esquina inferior derecha
          </p>
        </div>
      </div>

      <!-- Gu√≠a r√°pida -->
      <div class="bg-white rounded-2xl shadow-xl p-8">
        <h2 class="text-2xl font-bold text-gray-900 mb-6">üìö Gu√≠a R√°pida</h2>
        
        <div class="space-y-6">
          <!-- Android/Desktop -->
          <div class="border-l-4 border-green-500 pl-4">
            <h3 class="font-semibold text-gray-900 mb-2">‚úÖ Android / Desktop</h3>
            <ol class="list-decimal list-inside space-y-1 text-sm text-gray-600">
              <li>Abre el sitio en Chrome, Firefox o Edge</li>
              <li>Aparecer√° un popup pidiendo permiso para notificaciones</li>
              <li>Click en "Permitir"</li>
              <li>¬°Listo! Recibir√°s notificaciones</li>
            </ol>
          </div>

          <!-- iOS -->
          <div class="border-l-4 border-yellow-500 pl-4">
            <h3 class="font-semibold text-gray-900 mb-2">‚ö†Ô∏è iOS (iPhone/iPad)</h3>
            <ol class="list-decimal list-inside space-y-1 text-sm text-gray-600">
              <li>Abre el sitio en <strong>Safari</strong></li>
              <li>Toca el bot√≥n "Compartir" (icono ‚ÜóÔ∏è)</li>
              <li>Desplaza y toca "Agregar a pantalla de inicio"</li>
              <li><strong>Abre la app desde el √≠cono</strong> en tu pantalla de inicio</li>
              <li>Ahora s√≠ aparecer√° el popup de permisos</li>
              <li>Acepta los permisos</li>
              <li>¬°Listo! Recibir√°s notificaciones</li>
            </ol>
          </div>

          <!-- Qu√© notificaciones recibir√°s -->
          <div class="border-l-4 border-blue-500 pl-4">
            <h3 class="font-semibold text-gray-900 mb-2">üì± Notificaciones que recibir√°s:</h3>
            <ul class="list-disc list-inside space-y-1 text-sm text-gray-600">
              <li><strong>Como Vendedor:</strong> Cuando recibas un nuevo pedido</li>
              <li><strong>Como Cliente:</strong> Cuando confirmen tu pedido</li>
              <li><strong>Como Cliente:</strong> Cuando tu pedido est√© en camino</li>
              <li><strong>Como Cliente:</strong> Cuando llegue tu pedido</li>
              <li><strong>Como Cliente:</strong> Cuando completen tu pedido</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Componente de diagn√≥stico -->
  <PushDiagnostic client:load />
</BaseLayout>

