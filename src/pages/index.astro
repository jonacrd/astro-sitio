---
import BaseLayout from '@/layouts/BaseLayout.astro'
import { getCategories } from '@lib/products.server'
import { getFeaturedProducts, getBestSellingProducts } from '@lib/products-featured.server'
import SimpleMainBanner from '@components/react/SimpleMainBanner.tsx'
import SimpleCategoryBanners from '@components/react/SimpleCategoryBanners.tsx'
import SimpleSectionCarousel from '@components/react/SimpleSectionCarousel.tsx'
import ProductCarousel from '@components/react/ProductCarousel.tsx'
import BestSellingBanner from '@components/react/BestSellingBanner.tsx'

const categories = await getCategories()
const featuredProducts = await getFeaturedProducts(12)
const bestSellingProducts = await getBestSellingProducts(6)
---

<style>
  @keyframes fadeInOut {
    0%, 20% { opacity: 1; }
    25%, 95% { opacity: 0; }
    100% { opacity: 1; }
  }
  
  .category-card {
    animation: fadeIn 0.6s ease-out forwards;
    opacity: 0;
    transform: translateY(20px);
  }
  
  @keyframes fadeIn {
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<BaseLayout 
  title="Tienda Online - Inicio"
  description="Descubre nuestra amplia selección de productos tecnológicos de calidad"
>
  <!-- Main Banner -->
  <SimpleMainBanner client:load />

  <!-- Best Selling Products Banner -->
  <BestSellingBanner 
    products={bestSellingProducts}
    client:load 
  />


  <!-- Featured Products -->
  <ProductCarousel 
    title="⭐ Productos Destacados"
    subtitle="Nuestra selección especial de productos premium"
    products={featuredProducts}
    client:load 
  />

  <!-- Características -->
  <section class="py-12 sm:py-16 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-8 sm:mb-12">
        <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-3 sm:mb-4">
          ¿Por qué elegir nuestra tienda?
        </h2>
        <p class="text-sm sm:text-base text-gray-600 max-w-2xl mx-auto">
          Nos comprometemos a ofrecerte la mejor experiencia de compra online
        </p>
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 lg:gap-8">
        <!-- Calidad -->
        <div class="group relative overflow-hidden rounded-xl sm:rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 hover:scale-105">
          <div class="aspect-[4/3] bg-cover bg-center relative" style="background-image: url('https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=400&h=300&fit=crop&auto=format')">
            <div class="absolute inset-0 bg-gradient-to-t from-blue-900/80 via-blue-600/40 to-transparent"></div>
            <div class="absolute inset-0 flex flex-col items-center justify-end p-4 sm:p-6 text-white">
              <div class="bg-white/20 backdrop-blur-sm rounded-full p-3 sm:p-4 mb-3 sm:mb-4 group-hover:scale-110 transition-transform duration-300">
                <svg class="w-6 h-6 sm:w-8 sm:h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
              </div>
              <h3 class="text-lg sm:text-xl font-bold mb-2 group-hover:text-yellow-300 transition-colors">Calidad Garantizada</h3>
              <p class="text-white/90 text-center text-sm sm:text-base group-hover:text-white transition-colors">
                Todos nuestros productos pasan por estrictos controles de calidad
              </p>
            </div>
          </div>
        </div>

        <!-- Envío rápido -->
        <div class="group relative overflow-hidden rounded-xl sm:rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 hover:scale-105">
          <div class="aspect-[4/3] bg-cover bg-center relative" style="background-image: url('https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=400&h=300&fit=crop&auto=format')">
            <div class="absolute inset-0 bg-gradient-to-t from-green-900/80 via-green-600/40 to-transparent"></div>
            <div class="absolute inset-0 flex flex-col items-center justify-end p-4 sm:p-6 text-white">
              <div class="bg-white/20 backdrop-blur-sm rounded-full p-3 sm:p-4 mb-3 sm:mb-4 group-hover:scale-110 transition-transform duration-300">
                <svg class="w-6 h-6 sm:w-8 sm:h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
              </div>
              <h3 class="text-lg sm:text-xl font-bold mb-2 group-hover:text-yellow-300 transition-colors">Envío Rápido</h3>
              <p class="text-white/90 text-center text-sm sm:text-base group-hover:text-white transition-colors">
                Recibe tus productos en tiempo récord con nuestro servicio de envío
              </p>
            </div>
          </div>
        </div>

        <!-- Soporte -->
        <div class="group relative overflow-hidden rounded-xl sm:rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-500 hover:scale-105 sm:col-span-2 lg:col-span-1">
          <div class="aspect-[4/3] bg-cover bg-center relative" style="background-image: url('https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=400&h=300&fit=crop&auto=format')">
            <div class="absolute inset-0 bg-gradient-to-t from-purple-900/80 via-purple-600/40 to-transparent"></div>
            <div class="absolute inset-0 flex flex-col items-center justify-end p-4 sm:p-6 text-white">
              <div class="bg-white/20 backdrop-blur-sm rounded-full p-3 sm:p-4 mb-3 sm:mb-4 group-hover:scale-110 transition-transform duration-300">
                <svg class="w-6 h-6 sm:w-8 sm:h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192L5.636 18.364M12 2.25a9.75 9.75 0 11-9.75 9.75A9.75 9.75 0 0112 2.25z" />
                </svg>
              </div>
              <h3 class="text-lg sm:text-xl font-bold mb-2 group-hover:text-yellow-300 transition-colors">Soporte 24/7</h3>
              <p class="text-white/90 text-center text-sm sm:text-base group-hover:text-white transition-colors">
                Nuestro equipo está disponible para ayudarte cuando lo necesites
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Category Banners -->
  <SimpleCategoryBanners client:load />

  <!-- Categorías -->
  <section id="categories" class="py-12 sm:py-16 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-8 sm:mb-12">
        <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 mb-3 sm:mb-4">
          Explora nuestras categorías
        </h2>
        <p class="text-sm sm:text-base text-gray-600 max-w-2xl mx-auto">
          Encuentra exactamente lo que buscas en nuestras categorías organizadas
        </p>
      </div>

      {categories.length > 0 ? (
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
          {categories.map((category, index) => {
            const categoryImageSequences = {
              'ropa-hombre': [
                'https://images.unsplash.com/photo-1441986300917-64674bd600d8?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1551028719-00167b16eac5?w=400&h=300&fit=crop&auto=format'
              ],
              'ropa-mujer': [
                'https://images.unsplash.com/photo-1441984904996-e0b6ba687e04?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1515372039744-b8f02a3ae446?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1594633312681-425c7b97ccd1?w=400&h=300&fit=crop&auto=format'
              ],
              'tecnologia': [
                'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1511707171634-5f897ff02aa9?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1551650975-87deedd944c3?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=400&h=300&fit=crop&auto=format'
              ],
              'accesorios': [
                'https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1511499767150-a48a237f0083?w=400&h=300&fit=crop&auto=format'
              ],
              'hogar': [
                'https://images.unsplash.com/photo-1586023492125-27b2c045efd7?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400&h=300&fit=crop&auto=format'
              ],
              'deportes': [
                'https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1431324155629-1a6deb1dec8d?w=400&h=300&fit=crop&auto=format',
                'https://images.unsplash.com/photo-1551698618-1dfe5d97d256?w=400&h=300&fit=crop&auto=format'
              ]
            }
            const imageSequence = categoryImageSequences[category.slug as keyof typeof categoryImageSequences] || categoryImageSequences['ropa-hombre']
            
            return (
              <a 
                href={`/catalogo?category=${category.slug}`}
                class="category-card bg-white rounded-xl shadow-lg hover:shadow-2xl transition-all duration-500 overflow-hidden group hover:scale-105 hover:-translate-y-2"
                style={`animation-delay: ${index * 100}ms`}
              >
                <div class="aspect-[4/3] bg-cover bg-center relative overflow-hidden">
                  {imageSequence.map((imageUrl, imgIndex) => (
                    <img 
                      key={imgIndex}
                      src={imageUrl}
                      alt={category.name}
                      class={`absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 ${
                        imgIndex === 0 ? 'opacity-100' : 'opacity-0'
                      } group-hover:scale-110`}
                      style={{
                        animationDelay: `${imgIndex * 2}s`,
                        animation: `fadeInOut 6s infinite ${imgIndex * 2}s`
                      }}
                    />
                  ))}
                  <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
                  <div class="absolute bottom-3 left-3 right-3 sm:bottom-4 sm:left-4 sm:right-4">
                    <h3 class="text-lg sm:text-xl font-bold text-white mb-1 sm:mb-2 group-hover:text-yellow-300 transition-colors">
                      {category.name}
                    </h3>
                    <p class="text-white/90 text-xs sm:text-sm group-hover:text-white transition-colors">
                      Descubre productos de {category.name.toLowerCase()}
                    </p>
                  </div>
                </div>
                <div class="p-4 sm:p-6">
                  <div class="flex items-center justify-between">
                    <span class="text-xs sm:text-sm text-gray-500 group-hover:text-blue-600 transition-colors">
                      Ver productos →
                    </span>
                    <div class="w-6 h-6 sm:w-8 sm:h-8 bg-blue-100 rounded-full flex items-center justify-center group-hover:bg-blue-600 transition-colors">
                      <svg class="w-3 h-3 sm:w-4 sm:h-4 text-blue-600 group-hover:text-white transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                      </svg>
                    </div>
                  </div>
                </div>
              </a>
            )
          })}
        </div>
      ) : (
        <div class="text-center py-12">
          <p class="text-gray-500 text-lg">
            No hay categorías disponibles en este momento
          </p>
        </div>
      )}
    </div>
  </section>

  <!-- Section Carousel -->
  <SimpleSectionCarousel client:load />

  <!-- Call to Action -->
  <section class="py-12 sm:py-16 bg-blue-600 text-white">
    <div class="max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl sm:text-3xl font-bold mb-3 sm:mb-4">
        ¿Listo para empezar a comprar?
      </h2>
      <p class="text-base sm:text-xl mb-6 sm:mb-8 text-blue-100">
        Explora nuestro catálogo completo y encuentra los productos perfectos para ti
      </p>
      <a 
        href="/catalogo" 
        class="bg-yellow-400 text-blue-900 px-6 py-3 sm:px-8 sm:py-4 rounded-lg text-base sm:text-lg font-bold hover:bg-yellow-300 transition-colors inline-block min-h-11"
      >
        Ver todos los productos
      </a>
    </div>
  </section>
</BaseLayout>